%% -*- erlang -*-
[

 {exometer, [
             {defaults,
              [{['_'], function    , [{module, exometer_function}]},
               {['_'], counter     , [{module, exometer}]},
               {['_'], fast_counter, [{module, exometer}]},
               {['_'], gauge       , [{module, exometer}]},
               {['_'], histogram   , [{module, exometer_histogram}]},
               {['_'], spiral      , [{module, exometer_spiral}]},
               {['_'], duration    , [{module, exometer_folsom}]},
               {['_'], meter       , [{module, exometer_folsom}]}
              ]},
             {predefined, []},

             {report,
              [
               {reporters,
                [
                 {exometer_report_tty, []},
                 {exometer_report_snmp, [
                                         {mib_template, "priv/EXOMETER-METRICS-MIB.mib"},
                                         {mib_dir, "/tmp/exometer"}
                                        ]}
                ]},
               {subscribers,
                [
                 %% {select, {[{{[api,'_', '_'],'_','_'}, [], ['$_']}],
                 %%           exometer_report_tty, value, 15000}},

                 %% {exometer_report_snmp, [api, controller_account, request_invite], [mean, max], 15000}
                ]}
              ]}
            ]},

    {snmp, [
        {agent, [
            {priority, normal}, 
            {versions, [v2, v3]}, 
            {db_dir, "/tmp"}, 
            {db_init_error, true},
            {mibs, [
                "priv/mibs/EXOMETER-MIB.bin"
            ]},
            {mib_storage, [
                {module, snmpa_mib_storage_ets}
            ]}, 
            {target_cache, [
                {verbosity, info}
            ]}, 
            {symbolic_store, [
                {verbosity, info}
            ]}, 
            {local_db, [
                {repair,true},
                {auto_save,5000},
                {verbosity, info}
            ]}, 
            {error_report_module, snmpa_error_logger}, 
            {agent_type, master}, 
            {agent_verbosity, info}, 
            {discovery, [
                {terminating, [
                    {enable, false}
                ]}, 
                {originating, [
                    {enable, true}
                ]}
            ]}, 
            {config, [
                {dir, "priv/snmp"}, 
                {force_load, true}, 
                {verbosity, info}
            ]}, 
            {multi_threaded, true}, 
            {mib_server, [
                {mibentry_override,true},
                {trapentry_override,true},
                {verbosity, info},
                {cache,true}
            ]}, 
            {note_store, [
                {timeout,30000},
                {verbosity, info}
            ]}, 
            {net_if, [
                {module,snmpa_net_if},
                {verbosity, info},
                {options, [
                    {bind_to,false},
                    {no_reuse,false},
                    {req_limit,infinity}
                ]}
            ]}, 
            {audit_trail_log, [
                {type, read_write}, 
                {dir, "/tmp"}, 
                {size, {10240,10}}, 
                {repair, true}, 
                {seqno, false}
            ]}
        ]}
    ]},
    {lager, [
        {handlers, [
            {lager_console_backend, debug}
        ]}
    ]}
].
